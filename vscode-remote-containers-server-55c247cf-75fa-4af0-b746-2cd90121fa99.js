/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------------------------------------------*/

var Pn=Object.create;var me=Object.defineProperty;var _n=Object.getOwnPropertyDescriptor;var Fn=Object.getOwnPropertyNames;var bn=Object.getPrototypeOf,On=Object.prototype.hasOwnProperty;var h=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Ye=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Fn(t))!On.call(e,o)&&o!==r&&me(e,o,{get:()=>t[o],enumerable:!(n=_n(t,o))||n.enumerable});return e};var F=(e,t,r)=>(r=e!=null?Pn(bn(e)):{},Ye(t||!e||!e.__esModule?me(r,"default",{value:e,enumerable:!0}):r,e)),Bn=e=>Ye(me({},"__esModule",{value:!0}),e);var we=h((Ei,Ve)=>{Ve.exports=function(t,r,n){t(r),n&&n(r===!0?null:r)}});var X=h((qi,Ke)=>{"use strict";var ze=we();Ke.exports=function(t,r){if(!t)return function(o,i){return o?ze(i,o,r):i(!0)};Array.isArray(t)||(t=Object.keys(t).map(function(o){return t[o]}));var n=0;return function(o,i){if(o)return ze(i,o,r);n>=t.length?i(!0):i(null,t[n++])}}});var Qe=h((ki,Ze)=>{"use strict";var An=X();Ze.exports=function(e){return An(Object.keys(e))}});var ve=h((Si,Xe)=>{"use strict";var Rn=we();Xe.exports=function(t,r){return function(n,o){if(n)return Rn(o,n,r);if(t!=null){var i=t;t=null,o(null,i)}else o(!0)}}});var tt=h((Pi,et)=>{"use strict";et.exports=function(t){var r=0;return t=t||1/0,function(n,o){if(n)return o&&o(n);if(r>t)return o(!0);o(null,r++)}}});var nt=h((_i,rt)=>{"use strict";rt.exports=function(t){return t=t||Math.random,function(r,n){return r?n&&n(r):n(null,t())}}});var it=h((Fi,ot)=>{"use strict";ot.exports=function(){return function(t,r){r(!0)}}});var ut=h((bi,st)=>{"use strict";st.exports=function(t){return function(r,n){n(t)}}});var lt=h((Oi,ct)=>{"use strict";ct.exports={keys:Qe(),once:ve(),values:X(),count:tt(),infinite:nt(),empty:it(),error:ut()}});var D=h((Bi,ft)=>{"use strict";ft.exports=function(t,r){var n,o,i;r||(i=new Error("no done callback supplied"));function u(c){if(n=c,o)return u.abort();(function s(){for(var f=!0,l=!1;f;)if(l=!1,n(null,function(a,p){if(l=!0,a=a||o){if(f=!1,r)r(a===!0?null:a);else if(a&&a!==!0)throw console.warn(i),a}else t&&t(p)===!1||o?(f=!1,n(o||!0,r||function(){})):f||s()}),!l){f=!1;return}})()}return u.abort=function(c,s){if(typeof c=="function"&&(s=c,c=!0),o=c||!0,n)return n(o,s||function(){})},u}});var pt=h((Ai,at)=>{"use strict";var In=D();at.exports=function(t){return In(null,t)}});var ht=h((Ri,dt)=>{"use strict";var Tn=D();dt.exports=function(t){return Tn(function(r){console.log(r)},t)}});var $=h((Ii,gt)=>{gt.exports=function(t){return t&&(typeof t=="string"?function(r){return r[t]}:typeof t=="object"&&typeof t.exec=="function"?function(r){var n=t.exec(r);return n&&n[0]}:t)}});var wt=h((Ti,mt)=>{"use strict";function yt(e){return e}var Ln=$(),Nn=D();mt.exports=function(t,r){var n=!1;return r?t=Ln(t)||yt:(r=t,t=yt),Nn(function(o){if(t(o))return n=!0,r(null,o),!1},function(o){n||r(o===!0?null:o,null)})}});var ee=h((Li,vt)=>{"use strict";var Dn=D();vt.exports=function(t,r,n){n||(n=r,r=null);var o=Dn(function(i){r=t(r,i)},function(i){n(i,r)});return arguments.length===2?function(i){i(null,function(u,c){if(u)return n(u===!0?null:u);r=c,o(i)})}:o}});var xe=h((Ni,xt)=>{"use strict";var $n=ee();xt.exports=function(t){return $n(function(r,n){return r.push(n),r},[],t)}});var Et=h((Di,Ct)=>{"use strict";var Mn=xe();Ct.exports=function(){return t=>{let r,n,o=new Promise((i,u)=>{r=i,n=u});return Mn((i,u)=>{i?n(i):r(u)})(t),o}}});var kt=h(($i,qt)=>{"use strict";var Un=ee();qt.exports=function(t){return Un(function(r,n){return r+n},"",t)}});var Pt=h((Mi,St)=>{"use strict";St.exports={drain:D(),onEnd:pt(),log:ht(),find:wt(),reduce:ee(),collect:xe(),collectAsPromise:Et(),concat:kt()}});var Ft=h((Ui,_t)=>{"use strict";function Gn(e){return e}var Jn=$();_t.exports=function(t){return t?(t=Jn(t),function(r){return function(n,o){r(n,function(i,u){try{u=i?null:t(u)}catch(c){return r(c,function(){return o(c)})}o(i,u)})}}):Gn}});var Ot=h((Gi,bt)=>{"use strict";function Hn(e){return e}var Wn=$();bt.exports=function(t){if(!t)return Hn;t=Wn(t);var r=!1,n,o;return function(i){return function u(c,s){if(o)return s(o);c?(o=c,r?i(c,function(f){r?n=s:s(c)}):i(c,function(f){s(c)})):i(null,function(f,l){f?s(f):o?s(o):(r=!0,t(l,function(a,p){r=!1,o?(s(o),n&&n(o)):a?u(a,s):s(null,p)}))})}}}});var Ce=h((Ji,Bt)=>{var jn=$();function Yn(e){return e}Bt.exports=function(t){return typeof t=="object"&&typeof t.test=="function"?function(r){return t.test(r)}:jn(t)||Yn}});var te=h((Hi,At)=>{"use strict";var Vn=Ce();At.exports=function(t){return t=Vn(t),function(r){return function n(o,i){for(var u,c=!0;c;)c=!1,u=!0,r(o,function(s,f){if(!s&&!t(f))return u?c=!0:n(s,i);i(s,f)}),u=!1}}}});var It=h((Wi,Rt)=>{"use strict";var zn=Ce(),Kn=te();Rt.exports=function(t){return t=zn(t),Kn(function(r){return!t(r)})}});var Lt=h((ji,Tt)=>{"use strict";Tt.exports=function(t,r){var n=!1;function o(i){n||!r||(n=!0,r(i===!0?null:i))}return function(i){return function(u,c){return u&&o(u),i(u,function(s,f){s?o(s):t&&t(f),c(s,f)})}}}});var Dt=h((Yi,Nt)=>{"use strict";Nt.exports=function(t,r){r=r||{};var n=r.last||!1,o=!1;if(typeof t=="number"){n=!0;var i=t;t=function(){return--i}}return function(u){function c(s){u(!0,function(f){n=!1,s(f||!0)})}return function(s,f){o&&!s?n?c(f):f(o):(o=s)?u(o,f):u(null,function(l,a){(o=o||l)?f(o):t(a)?f(null,a):(o=!0,n?f(null,a):c(f))})}}}});var Ee=h((Vi,$t)=>{"use strict";function Zn(e){return e}var Qn=$(),Xn=te();$t.exports=function(t,r){t=Qn(t)||Zn;var n={};return Xn(function(o){var i=t(o);return n[i]?!!r:(n[i]=!0,!r)})}});var Ut=h((zi,Mt)=>{"use strict";var eo=Ee();Mt.exports=function(t){return eo(t,!0)}});var Jt=h((Ki,Gt)=>{"use strict";var to=X(),ro=ve();Gt.exports=function(){return function(t){var r;return function(n,o){n?r?r(n,function(c){t(c||n,o)}):t(n,o):r?i():u();function i(){r(null,function(c,s){c?c===!0?u():t(!0,function(f){o(c)}):o(null,s)})}function u(){r=null,t(null,function(c,s){if(c)return o(c);s&&typeof s=="object"?s=to(s):typeof s!="function"&&(s=ro(s)),r=s,i()})}}}}});var Wt=h((Zi,Ht)=>{"use strict";Ht.exports={map:Ft(),asyncMap:Ot(),filter:te(),filterNot:It(),through:Lt(),take:Dt(),unique:Ee(),nonUnique:Ut(),flatten:Jt()}});var qe=h((Qi,jt)=>{"use strict";jt.exports=function e(t){var r=arguments.length;if(typeof t=="function"&&t.length===1){for(var n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return function(c){if(n==null)throw new TypeError("partial sink should only be called once!");var s=n;switch(n=null,r){case 1:return e(c,s[0]);case 2:return e(c,s[0],s[1]);case 3:return e(c,s[0],s[1],s[2]);case 4:return e(c,s[0],s[1],s[2],s[3]);default:return s.unshift(c),e.apply(null,s)}}}var i=t;i&&typeof i.source=="function"&&(i=i.source);for(var o=1;o<r;o++){var u=arguments[o];typeof u=="function"?i=u(i):u&&typeof u=="object"&&(u.sink(i),i=u.source)}return i}});var Y=h((A,Kt)=>{"use strict";var Yt=lt(),Vt=Pt(),zt=Wt();A=Kt.exports=qe();A.pull=A;for(S in Yt)A[S]=Yt[S];var S;for(S in zt)A[S]=zt[S];var S;for(S in Vt)A[S]=Vt[S];var S});var ke=h((ls,Qt)=>{var cs=Qt.exports=function(e){(function t(){var r=!0,n=!1,o=!1;do o=!0,r=!1,e.call(this,function(){o?r=!0:t()}),o=!1;while(r)})()}});var Se=h((B,tr)=>{var fs=qe(),no=ke();function Xt(e){e.destroy?e.destroy():console.error("warning, stream-to-pull-stream: \nthe wrapped node-stream does not implement `destroy`, \nthis may cause resource leaks.")}function er(e,t,r){var n,o=!1,i;function u(){i||(i=!0,r&&r(n===!0?null:n))}function c(){o||(o=!0,f(),n?u():e(n=!0,u))}function s(l){f(),n||e(n=l,u)}function f(){t.on("finish",c),t.removeListener("close",c),t.removeListener("error",s)}t.on("close",c),t.on("finish",c),t.on("error",s),process.nextTick(function(){no(function(l){e(null,function(a,p){if(n=n||a,a===!0)return t._isStdio?u():t.end();if(n=n||a)return Xt(t),u(n);if(t._isStdio)t.write(p,function(){l()});else{var d=t.write(p);d===!1?t.once("drain",l):l()}})})})}function oo(e){var t=!1,r=!1,n;function o(){var i=e.read();if(i!==null&&n){var u=n;n=null,u(null,i)}}return e.on("readable",function(){r=!0,n&&o()}).on("end",function(){t=!0,n&&n(t)}).on("error",function(i){t=i,n&&n(t)}),function(i,u){n=u,t?u(t):r&&o()}}function re(e){var t=[],r=[],n,o=!1,i;function u(){for(;(t.length||n)&&r.length;)r.shift()(t.length?null:n,t.shift());!t.length&&o&&(o=!1,e.resume())}return e.on("data",function(c){t.push(c),u(),t.length&&e.pause&&(o=!0,e.pause())}),e.on("end",function(){n=!0,u()}),e.on("close",function(){n=!0,u()}),e.on("error",function(c){n=c,u()}),function(c,s){if(!s)throw new Error("*must* provide cb");if(c){let l=function(){for(;r.length;)r.shift()(c);s(c)};var f=l;if(n)return l();e.once("close",l),Xt(e)}else r.push(s),u()}}var io=re,ne=function(e,t){return function(r){return er(r,e,t)}},oe=function(e){return re(e)};B=tr.exports=function(e,t){return e.writable&&e.write?e.readable?function(r){return er(r,e,t),re(e)}:ne(e,t):oe(e)};B.sink=ne;B.source=oe;B.read=io;B.read1=re;B.read2=oo;B.duplex=function(e,t){return{source:oe(e),sink:ne(e,t)}};B.transform=function(e){return function(t){var r=oe(e);return ne(e)(t),r}}});var fr=h((hs,lr)=>{var fo=ke();lr.exports=function(e,t){return function(r){var n=[],o,i;function u(f){n.push(f)}e=e||function(f){this.queue(f)},t=t||function(){this.queue(null)};var c={emit:function(f,l){f=="data"&&u(l),f=="end"&&(o=!0,u(null)),f=="error"&&(i=l)},queue:u},s;return function(f,l){if(o=o||f,f)return r(f,function(){if(s){var a=s;s=null,a(f)}l(f)});s=l,fo(function a(p){if(s)if(l=s,i)s=null,l(i);else if(n.length){var d=n.shift();s=null,l(d===null,d)}else r(o,function(g,y){if(g&&g!==!0)return i=g,p();if(o=o||g)t.call(c);else if(y!==null&&(e.call(c,y),i||o))return r(i||o,function(){s=null,l(i||o)});p(a)})})}}}});var pr=h((gs,ar)=>{ar.exports=function(){var e=[],t=0;function r(){return e.reduce(function(n,o){return n+o.length},0)}return{length:t,data:this,add:function(n){if(!Buffer.isBuffer(n))throw new Error("data must be a buffer, was: "+JSON.stringify(n));return this.length=t=t+n.length,e.push(n),this},has:function(n){return n==null?t>0:t>=n},get:function(n){var o;if(n==null||n===t){t=0;var i=e;return e=[],i.length==1?i[0]:Buffer.concat(i)}else if(e.length>1&&n<=(o=e[0].length)){var u=e[0].slice(0,n);return n===o?e.shift():e[0]=e[0].slice(n,o),t-=n,u}else if(n<t){for(var c=[],s=0;s+e[0].length<n;){var f=e.shift();s+=f.length,c.push(f)}return s<n&&(c.push(e[0].slice(0,n-s)),e[0]=e[0].slice(n-s,e[0].length),this.length=t=t-n),Buffer.concat(c)}else throw new Error("could not get "+n+" bytes")}}}});var yr=h((ys,gr)=>{"use strict";var ao=pr();function po(e){return Number.isFinite(e)}function dr(e){return typeof e=="function"}function hr(e,t){return t?function(r,n){var o=setTimeout(function(){e(new Error("pull-reader: read exceeded timeout"),n)},t);e(r,function(i,u){clearTimeout(o),n(i,u)})}:e}gr.exports=function(e){var t=[],r,n,o=!1,i=ao(),u,c,s;function f(){for(;t.length;)if(t[0].length==null&&i.has(1))t.shift().cb(null,i.get());else if(i.has(t[0].length)){var p=t.shift();p.cb(null,i.get(p.length))}else if(u==!0&&t[0].length&&i.length<t[0].length){var d="stream ended with:"+i.length+" but wanted:"+t[0].length;t.shift().cb(new Error(d))}else if(u)t.shift().cb(u);else return!!t.length;return t.length||!i.has(1)||s}function l(){var p=f();p&&!o&&r&&!o&&!c&&(o=!0,n(null,function(d,g){if(o=!1,d)return u=d,f();i.add(g),l()}))}function a(p){if(s){for(;t.length;)t.shift().cb(s);return cb&&cb(s)}n=hr(p,e),r=p,l()}return a.abort=function(p,d){s=p||!0,r?(o=!0,r(s,function(){for(;t.length;)t.shift().cb(s);d&&d(s)})):d()},a.read=function(p,d,g){if(dr(d)&&(g=d,d=e),dr(g))t.push({length:po(p)?p:null,cb:g}),l();else return c=!0,function(y,m){if(o||i.has(1)){if(y)return r(y,m);t.push({length:null,cb:m}),l()}else hr(r,d)(y,function(C,O){m(C,O)})}},a}});var wr=h((ms,mr)=>{var M=1e3,U=M*60,G=U*60,R=G*24,ho=R*7,go=R*365.25;mr.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return yo(e);if(r==="number"&&isFinite(e))return t.long?wo(e):mo(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function yo(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*go;case"weeks":case"week":case"w":return r*ho;case"days":case"day":case"d":return r*R;case"hours":case"hour":case"hrs":case"hr":case"h":return r*G;case"minutes":case"minute":case"mins":case"min":case"m":return r*U;case"seconds":case"second":case"secs":case"sec":case"s":return r*M;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function mo(e){var t=Math.abs(e);return t>=R?Math.round(e/R)+"d":t>=G?Math.round(e/G)+"h":t>=U?Math.round(e/U)+"m":t>=M?Math.round(e/M)+"s":e+"ms"}function wo(e){var t=Math.abs(e);return t>=R?ue(e,t,R,"day"):t>=G?ue(e,t,G,"hour"):t>=U?ue(e,t,U,"minute"):t>=M?ue(e,t,M,"second"):e+" ms"}function ue(e,t,r,n){var o=t>=r*1.5;return Math.round(e/r)+" "+n+(o?"s":"")}});var be=h((ws,vr)=>{function vo(e){r.debug=r,r.default=r,r.coerce=s,r.disable=i,r.enable=o,r.enabled=u,r.humanize=wr(),r.destroy=f,Object.keys(e).forEach(l=>{r[l]=e[l]}),r.names=[],r.skips=[],r.formatters={};function t(l){let a=0;for(let p=0;p<l.length;p++)a=(a<<5)-a+l.charCodeAt(p),a|=0;return r.colors[Math.abs(a)%r.colors.length]}r.selectColor=t;function r(l){let a,p=null,d,g;function y(...m){if(!y.enabled)return;let C=y,O=Number(new Date),qn=O-(a||O);C.diff=qn,C.prev=a,C.curr=O,a=O,m[0]=r.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");let Q=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,(ye,kn)=>{if(ye==="%%")return"%";Q++;let je=r.formatters[kn];if(typeof je=="function"){let Sn=m[Q];ye=je.call(C,Sn),m.splice(Q,1),Q--}return ye}),r.formatArgs.call(C,m),(C.log||r.log).apply(C,m)}return y.namespace=l,y.useColors=r.useColors(),y.color=r.selectColor(l),y.extend=n,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(d!==r.namespaces&&(d=r.namespaces,g=r.enabled(l)),g),set:m=>{p=m}}),typeof r.init=="function"&&r.init(y),y}function n(l,a){let p=r(this.namespace+(typeof a>"u"?":":a)+l);return p.log=this.log,p}function o(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];let a,p=(typeof l=="string"?l:"").split(/[\s,]+/),d=p.length;for(a=0;a<d;a++)p[a]&&(l=p[a].replace(/\*/g,".*?"),l[0]==="-"?r.skips.push(new RegExp("^"+l.slice(1)+"$")):r.names.push(new RegExp("^"+l+"$")))}function i(){let l=[...r.names.map(c),...r.skips.map(c).map(a=>"-"+a)].join(",");return r.enable(""),l}function u(l){if(l[l.length-1]==="*")return!0;let a,p;for(a=0,p=r.skips.length;a<p;a++)if(r.skips[a].test(l))return!1;for(a=0,p=r.names.length;a<p;a++)if(r.names[a].test(l))return!0;return!1}function c(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function s(l){return l instanceof Error?l.stack||l.message:l}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}vr.exports=vo});var xr=h((E,ce)=>{E.formatArgs=Co;E.save=Eo;E.load=qo;E.useColors=xo;E.storage=ko();E.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();E.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function xo(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Co(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+ce.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(r++,o==="%c"&&(n=r))}),e.splice(n,0,t)}E.log=console.debug||console.log||(()=>{});function Eo(e){try{e?E.storage.setItem("debug",e):E.storage.removeItem("debug")}catch{}}function qo(){let e;try{e=E.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function ko(){try{return localStorage}catch{}}ce.exports=be()(E);var{formatters:So}=ce.exports;So.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var Er=h((vs,Cr)=>{"use strict";Cr.exports=(e,t)=>{t=t||process.argv;let r=e.startsWith("-")?"":e.length===1?"-":"--",n=t.indexOf(r+e),o=t.indexOf("--");return n!==-1&&(o===-1?!0:n<o)}});var kr=h((xs,qr)=>{"use strict";var Po=require("os"),P=Er(),x=process.env,J;P("no-color")||P("no-colors")||P("color=false")?J=!1:(P("color")||P("colors")||P("color=true")||P("color=always"))&&(J=!0);"FORCE_COLOR"in x&&(J=x.FORCE_COLOR.length===0||parseInt(x.FORCE_COLOR,10)!==0);function _o(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function Fo(e){if(J===!1)return 0;if(P("color=16m")||P("color=full")||P("color=truecolor"))return 3;if(P("color=256"))return 2;if(e&&!e.isTTY&&J!==!0)return 0;let t=J?1:0;if(process.platform==="win32"){let r=Po.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(r[0])>=10&&Number(r[2])>=10586?Number(r[2])>=14931?3:2:1}if("CI"in x)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(r=>r in x)||x.CI_NAME==="codeship"?1:t;if("TEAMCITY_VERSION"in x)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(x.TEAMCITY_VERSION)?1:0;if(x.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in x){let r=parseInt((x.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(x.TERM_PROGRAM){case"iTerm.app":return r>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(x.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(x.TERM)||"COLORTERM"in x?1:(x.TERM==="dumb",t)}function Oe(e){let t=Fo(e);return _o(t)}qr.exports={supportsColor:Oe,stdout:Oe(process.stdout),stderr:Oe(process.stderr)}});var Pr=h((v,fe)=>{var bo=require("tty"),le=require("util");v.init=Lo;v.log=Ro;v.formatArgs=Bo;v.save=Io;v.load=To;v.useColors=Oo;v.destroy=le.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");v.colors=[6,2,3,4,5,1];try{let e=kr();e&&(e.stderr||e).level>=2&&(v.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}v.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{let r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(o,i)=>i.toUpperCase()),n=process.env[t];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),e[r]=n,e},{});function Oo(){return"colors"in v.inspectOpts?!!v.inspectOpts.colors:bo.isatty(process.stderr.fd)}function Bo(e){let{namespace:t,useColors:r}=this;if(r){let n=this.color,o="\x1B[3"+(n<8?n:"8;5;"+n),i=`  ${o};1m${t} \x1B[0m`;e[0]=i+e[0].split(`
`).join(`
`+i),e.push(o+"m+"+fe.exports.humanize(this.diff)+"\x1B[0m")}else e[0]=Ao()+t+" "+e[0]}function Ao(){return v.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Ro(...e){return process.stderr.write(le.format(...e)+`
`)}function Io(e){e?process.env.DEBUG=e:delete process.env.DEBUG}function To(){return process.env.DEBUG}function Lo(e){e.inspectOpts={};let t=Object.keys(v.inspectOpts);for(let r=0;r<t.length;r++)e.inspectOpts[t[r]]=v.inspectOpts[t[r]]}fe.exports=be()(v);var{formatters:Sr}=fe.exports;Sr.o=function(e){return this.inspectOpts.colors=this.useColors,le.inspect(e,this.inspectOpts).split(`
`).map(t=>t.trim()).join(" ")};Sr.O=function(e){return this.inspectOpts.colors=this.useColors,le.inspect(e,this.inspectOpts)}});var Ae=h((Cs,Be)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Be.exports=xr():Be.exports=Pr()});var Dr=h((I,Nr)=>{var No=fr(),Do=yr(),_r=Ae(),Fr=0,br=1,Or=2,Br="GOODBYE";function Ar(e){let t=Buffer.alloc(9),r=0,n=e.value!==void 0?e.value:e.end;return typeof e=="string"&&e===Br?(t.fill(0),[t,null]):(typeof n=="string"?(r=br,n=Buffer.from(n,"utf-8")):Buffer.isBuffer(n)?r=Fr:(r=Or,n=Buffer.from(JSON.stringify(n),"utf-8")),r=e.stream<<3|e.end<<2|r,t[0]=r,t.writeUInt32BE(n.length,1),t.writeInt32BE(e.req||0,5),[t,n])}function Rr(e){if(e.length!==9)throw new Error("expected header to be 9 bytes long");let t=e[0],r=e.readUInt32BE(1);return{req:e.readInt32BE(5),stream:!!(t&8),end:!!(t&4),value:null,length:r,type:t&3}}function Ir(e,t){if(e.length!==t.length)throw new Error("incorrect length, expected:"+t.length+" found:"+e.length);if(t.type===Fr)t.value=e;else if(t.type===br)t.value=e.toString();else if(t.type===Or)t.value=JSON.parse(e.toString());else throw new Error("unknown message type");return t}function Tr(e){return No(function(r){e&&e("encoded: %o",r);let[n,o]=Ar(r);this.queue(n),o!==null&&this.queue(o)})}function Lr(e){let t=Do(),r=!1;return function(o){return t(o),function(u,c){if(r)return c(!0);if(u)return t.abort(u,c);t.read(9,function(f,l){if(f)return c(f);let a=Rr(l);if(a.length===0)return r=!0,c(null,Br);t.read(a.length,function(d,g){if(d)return c(d);try{Ir(g,a)}catch(y){return c(y)}e&&e("decoded: %o",a),c(null,a)})})}}}I=Nr.exports=function(t,r){let n=r===!0?_r("packet-stream-codec"):typeof r=="string"?_r(r):null;return{source:Tr(n)(t.source),sink(o){return t.sink(Lr(n)(o))}}};I.encodePair=Ar;I.decodeHead=Rr;I.decodeBody=Ir;I.encode=Tr;I.decode=Lr});var Re=h((Es,$r)=>{function $o(e){return e&&(e===!0?!0:{message:e.message,name:e.name,stack:e.stack})}function Mo(e){console.error("packet-stream asked to read after closed",e)}$r.exports={flat:$o,closedread:Mo}});var Gr=h((qs,Ur)=>{var{flat:Mr,closedread:Uo}=Re();function ae(e,t,r){this.id=e,this.read=null,this.writeEnd=null,this.readEnd=null,this._ps=t,this._remove=r}ae.prototype.write=function(e,t){let r=this._ps;t?(this.writeEnd=t,r&&(r.read({req:this.id,stream:!0,end:!0,value:Mr(t)}),this.readEnd&&this.destroy(t),r._maybedone(t))):r&&r.read({req:this.id,stream:!0,end:!1,value:e})};ae.prototype.end=function(e){this.write(null,Mr(e||!0))};ae.prototype.destroy=function(e){if(this.writeEnd){if(!this.readEnd){this.readEnd=!0;try{this.read&&this.read(null,e)}catch(t){console.error("Exception thrown by PacketStream substream end handler",t),console.error(t.stack)}}}else{if(this.writeEnd=!0,!this.readEnd){this.readEnd=!0;try{this.read(null,e)}catch(t){console.error("Exception thrown by PacketStream substream end handler",t),console.error(t.stack)}}this.write(null,e)}this._ps&&(this._remove(),this._remove=null,this.read=Uo,this._ps=null)};Ur.exports=ae});var Wr=h((ks,Hr)=>{var Jr=Gr(),{flat:Ie,closedread:Go}=Re();function k(e){this.ended=!1,this.opts=e,this._req_counter=1,this._requests=new Map,this._instreams=new Map,this._outstreams=new Map,this._closecbs=[],this._closing=!1,this._closed=!1,e.close&&this._closecbs.push(e.close)}k.prototype.message=function(e){this.read({req:0,stream:!1,end:!1,value:e})};k.prototype.request=function(e,t){if(this._closing)return t(new Error("parent stream is closing"));let r=this._req_counter++;this._requests.set(r,(n,o)=>{this._requests.delete(r),t(n,o),this._maybedone(n)}),this.read({req:r,stream:!1,end:!1,value:e})};k.prototype.stream=function(){if(this._closing)throw new Error("parent stream is closing");let e=this._req_counter++,t=new Jr(e,this,()=>{this._outstreams.delete(e)});return this._outstreams.set(e,t),t};k.prototype.close=function(e){if(!e)throw new Error("packet-stream.close *must* have callback");if(this._closed)return e();this._closecbs.push(e),this._closing=!0,this._maybedone()};k.prototype.destroy=function(e){e=e||Ie(e),this.ended=e,this._closing=!0;let t=e===!0?new Error("unexpected end of parent stream"):e,r=0;this._requests.forEach(n=>{r++,n(t)}),this._instreams.forEach(n=>{r++,n.writeEnd=!0,n.destroy(t)}),this._outstreams.forEach(n=>{r++,n.writeEnd=!0,n.destroy(t)}),r===0&&e===!0&&(t=null),this._maybedone(t)};k.prototype._maybedone=function(e){this._closed||!this._closing||this._requests.size!==0||this._instreams.size!==0||this._outstreams.size!==0||(this.read(null,e||!0),this._closed=!0,this._closecbs.forEach(t=>{t(e)}),this.opts=null,this._closecbs.length=0,this.read=Go,this._requests.clear(),this._instreams.clear(),this._outstreams.clear())};k.prototype.read=function(e){console.error("please overwrite read method to do IO",e)};k.prototype.write=function(e,t){this.ended||(t?this.destroy(t):e.req&&!e.stream?this._onrequest(e):e.req&&e.stream?this._onstream(e):this._onmessage(e))};k.prototype._onmessage=function(e){this.opts&&typeof this.opts.message=="function"&&this.opts.message(e.value)};k.prototype._onrequest=function(e){let t=e.req*-1;if(e.req<0)this._requests.has(t)&&this._requests.get(t)(e.end?e.value:null,e.end?null:e.value);else if(this.opts&&typeof this.opts.request=="function"){let r=!1;this.opts.request(e.value,(n,o)=>{if(r)throw new Error("cb called twice from local api");r=!0,n?this.read({value:Ie(n),end:!0,req:t}):this.read({value:o,end:!1,req:t}),this._maybedone()})}else{if(this.ended){let r=this.ended===!0?new Error("unexpected end of parent stream"):this.ended;this.read({value:Ie(r),end:!0,stream:!1,req:t})}else this.read({value:{message:"Unable to handle requests",name:"NO_REQUEST_HANDLER",stack:null},end:!0,stream:!1,req:t});this._maybedone()}};k.prototype._onstream=function(e){if(e.req<0){let t=e.req*-1,r=this._outstreams.get(t);if(!r)return console.error("no stream for incoming msg",e);e.end?(r.writeEnd&&this._outstreams.delete(t),r.readEnd=!0,r.read(null,e.value),this._maybedone()):r.read(e.value)}else{let t=e.req,r=this._instreams.get(t);r||(r=new Jr(t*-1,this,()=>{this._instreams.delete(t)}),this._instreams.set(t,r),this.opts&&typeof this.opts.stream=="function"&&this.opts.stream(r)),e.end?(r.writeEnd&&this._instreams.delete(t),r.readEnd=!0,r.read&&r.read(null,e.value),this._maybedone()):r.read?r.read(e.value):console.error("no .read for stream:",r.id,"dropped:",e)}};Hr.exports=e=>new k(e)});var Yr=h((Ss,z)=>{"use strict";var Jo=Y();function Ho(e){let t=!1;return(r,n)=>{t||(t=!0,e(r,n))}}function Te(e,t){let r=[],n=!1,o=!1,i,u,c=Ho((s,f)=>{t&&t(s,f),e=null,t=null,i=null,u&&u(s||!0,()=>{})});return e.read=function(s,f){if(n=n||f,i){let l=i;i=null,l(n,s)}else!n&&!o&&r.push(s);n&&c(n!==!0?n:null)},{source(s,f){s?(e&&e.write(null,s),f(s),r.length=0,o=!0,c(s!==!0?s:null)):r.length?f(null,r.shift()):n?f(n):i=f},sink(s){if(n)return u=null,s(n,()=>{});u=s,Jo.drain(f=>{if(n)return!1;e.write(f)},f=>{e&&!e.writeEnd&&e.write(null,f||!0),c&&c(f)})(s)}}}function jr(e,t){return Te(e,r=>{e.writeEnd||e.write(null,r||!0),t&&t(r)})}function Wo(e){return jr(e).source}function jo(e,t){return jr(e,t).sink}z.exports=Te;z.exports.source=Wo;z.exports.sink=jo;z.exports.duplex=Te});var zr=h((Ps,Vr)=>{Vr.exports=function(t){var r,n,o;function i(u){return function(c,s){u(c,function(f,l){if(f&&!o)return o=!0,s(null,t);f&&r?s(f):f?n=s:s(null,l)})}}return i.end=function(){return r=!0,n&&n(r),i},i}});var Zr=h((_s,Kr)=>{var Yo=zr(),Le=Y();Kr.exports=function(e,t){t=t||"GOODBYE";var r=Yo(t);return{source:Le(e.source,r),sink:Le(Le.filter(function(n){if(n!==t)return!0;r.end()}),e.sink)}}});var K=h(_=>{"use strict";var pe=Y();function Vo(e){return e?Object.keys(e).length===0:!0}_.set=function(t,r,n){let o,i;for(let u=0;u<r.length;u++){let c=r[u];t[c]=t[c]||{},o=t,i=c,t=t[c]}o[i]=n};_.get=function(t,r){if(typeof r=="string")return t[r];let n;for(let o=0;o<r.length;o++){let i=r[o];if(n=t=t[i],t==null)return t}return n};_.prefix=function(t,r){let n;for(let o=0;o<r.length;o++){let i=r[o];if(n=t=t[i],typeof t!="object")return t}return typeof n!="object"?!!n:!1};function zo(e,t){for(let r in t){let n=t[r];e[n]||(e[n]={}),e=e[n]}return e}function Ko(e,t){(function r(n,o){let i=t[o];if(n)t.length-1===o?delete n[i]:o<t.length&&r(n[i],o+1);else return;Vo(n[i])&&delete n[i]})(e,0)}function Zo(e,t){for(let r in t)e[r]=t[r];return e}_.mount=function(t,r,n){if(!Array.isArray(r))throw new Error("path must be array of strings");return Zo(zo(t,r),n)};_.unmount=function(t,r){return Ko(t,r)};var de=e=>e==="source",he=e=>e==="sink",Ne=e=>e==="duplex",Qo=e=>e==="sync",Xo=e=>e==="async",Qr=e=>Qo(e)||Xo(e),ei=e=>de(e)||he(e)||Ne(e);_.isRequest=Qr;_.isStream=ei;function De(e){return function(t){t(e||!0,()=>{})}}function Xr(e){return{source:pe.error(e),sink:De(e)}}_.errorAsStream=function(t,r){return de(t)?pe.error(r):he(t)?De(r):Xr(r)};_.errorAsStreamOrCb=function(t,r,n){return Qr(t)?n(r):Ne(t)?Xr(r):de(t)?pe.error(r):he(t)?De(r):n(r)};_.pipeToStream=function(t,r,n){de(t)?r(n):he(t)?n(r):Ne(t)&&pe(r,n,r)}});var $e=h((bs,en)=>{"use strict";function ti(e){return typeof e=="string"?[`Error: ${e}`]:e.stack?e.stack.split(`
`):[`${e.name}: ${e.message}`]}en.exports=function(t,r){let n=new Error(r),o=n.stack.split(`
`);o.splice(1,1);let i=ti(t);i[0]="  "+i[0];for(let u=1;u<o.length;u++)if(i.includes(o[u])){o.splice(u);break}return n.stack=o.concat(i).join(`
`),n}});var on=h((Os,nn)=>{"use strict";var ri=Wr(),Me=Yr(),ni=Zr(),H=K(),tn=$e(),rn=Ae()("muxrpc:psc");nn.exports=function(t,r,n){let o=ri({message(){},request(u,c){if(!Array.isArray(u.args))return c(new Error(`invalid request, args should be array, was: ${JSON.stringify(u)}`));let s=u.name,f=u.args,l=!1,a=!1;f.push((p,d)=>{a=!0,l=!0,c(p,d)});try{t("async",s,f)}catch(p){if(l||a)throw tn(p,"no callback provided to muxrpc async funtion");c(p)}},stream(u){u.read=function(s,f){if(f)return u.write(null,f);let{name:l,type:a,args:p}=s,d,g;if(u.read=null,!H.isStream(a))return u.write(null,new Error(`unsupported stream type: ${a}`));try{g=t(a,l,p)}catch(C){d=C}let m=Me[a==="source"?"sink":a==="sink"?"source":"duplex"](u);return H.pipeToStream(a,m,d?H.errorAsStream(a,d):g)}},close(u){if(o=null,i.ended=!0,!i.closed&&(i.closed=!0,n)){let c=n;n=null,c(u)}}}),i=ni(Me(o,()=>{}));return i=r?r(i,rn.enabled?rn.namespace:!1):i,i.remoteCall=function(u,c,s,f){if(c==="emit")return o.message(s);if(!(H.isRequest(u)||H.isStream(u)))throw new Error(`unsupported type: ${JSON.stringify(u)}`);if(H.isRequest(u))return o.request({name:c,args:s},f);let l=o.stream(),a=Me[u](l,f);return l.write({name:c,args:s,type:u}),a},i.isOpen=function(){return!o.ended},i.close=function(u,c){if(typeof u=="function"&&(c=u,u=!1),!o){c&&c();return}if(u){o.destroy(u),c&&c();return}return o.close(s=>{if(c)c(s);else if(s)throw tn(s,"no callback provided for muxrpc close")}),this},i.closed=!1,i}});var un=h((Bs,sn)=>{"use strict";var oi=$e(),ii=K();function Ue(e,t,r,n){for(let o in t){let i=t[o],u=r?r.concat(o):[o];if(i&&typeof i=="object"){let c=i;e[o]=Ue({},c,u,n)}else{let c=i;e[o]=(...s)=>n(c,u,s)}}return e}function si(e){if(e)throw oi(e,"callback not provided")}function ui(e,t,r,n){e=e||{};function o(i,u,c){let s=typeof c[c.length-1]=="function"?c.pop():i==="sync"||i==="async"?null:si;if(typeof s=="function"){let f;try{f=r(i,u,c,s)}catch(l){return ii.errorAsStreamOrCb(i,l,s)}return f}else return new Promise((f,l)=>{r(i,u,c,(a,p)=>{a?l(a):f(p)})})}return n?o("async","manifest",[function(i,u){if(i)return n(i);Ue(e,u,null,o),n(null,u,e)}]):Ue(e,t,null,o),e}sn.exports=ui});var fn=h((As,ln)=>{"use strict";var ge=K();function cn(e){return Array.isArray(e)?e:e.split(".")}function ci(e){return e&&typeof e.pre=="function"&&typeof e.test=="function"&&typeof e.post=="function"}ln.exports=function(t){if(ci(t))return t;if(typeof t=="function")return{pre:t};let r=null,n={};function o(i){if(i.allow){r={};for(let u of i.allow)ge.set(r,cn(u),!0)}else r=null;if(i.deny)for(let u of i.deny)ge.set(n,cn(u),!0);else n={};return this}return t&&o(t),o.pre=i=>{if(i=Array.isArray(i)?i:[i],r&&!ge.prefix(r,i))return new Error(`method:${i} is not in list of allowed methods`);if(n&&ge.prefix(n,i))return new Error(`method:${i} is on list of disallowed methods`)},o.post=()=>{},o.test=i=>o.pre(i),o.get=()=>({allow:r,deny:n}),o}});var pn=h((Rs,an)=>{"use strict";var li=fn(),Ge=K();an.exports=function(t,r,n){n=li(n);function o(u,c){return u===Ge.get(r,c)}function i(u,c,s){if(c==="emit")throw new Error("emit has been removed");if(u==="async"&&o("sync",c)){let f=s.pop(),l;try{l=Ge.get(t,c).apply(this,s)}catch(a){return f(a)}return f(null,l)}if(!o(u,c))throw new Error(`no ${u}:${c}`);return Ge.get(t,c).apply(this,s)}return function(c,s,f){let l=n.pre(s,f);if(l)throw l;return i.call(this,c,s,f)}}});var gn=h((Is,hn)=>{"use strict";var fi=Dr(),ai=require("events").EventEmitter,pi=on(),di=un(),hi=pn();function dn(e,t,r,n,o,i,u){let c;typeof e=="function"&&(c=e,e={}),t=t||{},e=e||{};let s=new ai;i||(i=fi);let f,l={_emit(p,d){return s&&s._emit(p,d),l},id:n},a=pi(hi(r,t,o).bind(l),i,p=>{if(!s.closed&&(s.closed=!0,s.emit("closed"),f)){let d=f;f=null,d(p)}});if(di(s,e,(p,d,g,y)=>{if(a.closed)throw new Error("stream is closed");return a.remoteCall(p,d,g,y)},c),s._emit=s.emit,u){Object.__defineGetter__.call(s,"id",()=>l.id),Object.__defineSetter__.call(s,"id",d=>{l.id=d});let p=!0;s.createStream=d=>{if(f=d,p)return p=!1,a;throw new Error("one stream per rpc")}}else s.stream=a;return s.closed=!1,s.close=function(p,d){return a.close(p,d),this},s}hn.exports=function(e,t,r){return arguments.length>3?dn.apply(this,arguments):function(n,o,i){return dn(e,t,n,i,o,r,!0)}}});var vi={};module.exports=Bn(vi);var mn=F(require("net")),wn=F(require("http")),j=F(require("fs")),vn=F(require("path")),Je=F(require("child_process")),We=F(Y()),He=require("util");var V=F(require("net"));var w=F(require("fs")),b=require("util");var Zt=(0,b.promisify)(w.readFile),Xi=(0,b.promisify)(w.writeFile),es=(0,b.promisify)(w.appendFile),ts=(0,b.promisify)(w.rename),rs=(0,b.promisify)(w.readdir),ns=(0,b.promisify)(w.unlink);var os=(0,b.promisify)(w.rmdir),is=(0,b.promisify)(w.rm),ss=(0,b.promisify)(w.copyFile);var Pe=Se(),rr=e=>{if("port"in e)return Pe.duplex(V.connect(e.port,e.host));let t=e.socketPath;if(process.platform!=="win32"||t.startsWith("\\\\.\\pipe\\"))return Pe.duplex(V.connect(t));let r=new V.Socket;return co(r,t)};function so(e){let t=[];return e.split("-").map(r=>{let n=r.match(/.{2}/g);n!==null&&n.reverse().map(o=>{t.push(parseInt(o,16))})}),Buffer.from(t)}function uo(e,t,r){return t||r===void 0?{headerSize:e,err:t}:e===0?{headerSize:e,data:r}:r.length>e?(r=r.slice(e,r.length),e=0,{headerSize:e,data:r}):(e=e-r.length,{headerSize:e})}function co(e,t){let r=0,n=[],o=[],i,u=l=>{l instanceof Error&&console.error(l),e.destroy();for(let a of n)a.cb(l,void 0);n=[];for(let a of o)a(l,(p,d)=>{});o=[]};function c(l,a){i.source(l,function(p,d){let g=uo(r,p,d);r=g.headerSize,g.err||g.data?a(g.err||null,g.data):c(l,a)})}return(async()=>{let l=await Zt(t),p=l.toString().match(/!<socket >(\d+)( s)? ((([A-Fa-f0-9]{2}){4}-?){4})/),d,g;if(p!==null){let y=p[1],m=p[3];d=parseInt(y,10);let C=so(m),O=Buffer.alloc(12);O.writeUInt32LE(process.pid,0),g=Buffer.concat([C,O]),r=16+3*4}else{let y=l.indexOf(10);d=parseInt(l.slice(0,y).toString(),10),g=l.slice(y+1),r=0}e.on("error",y=>{u(y)}),e.connect(d,"127.0.0.1",()=>{e.write(g,y=>{if(!y){i=Pe.duplex(e);for(let m of n)c(m.abort,m.cb);n=[];for(let m of o)i.sink(m);o=[]}})})})().catch(l=>{u(l)}),{source:function(l,a){i!==void 0?c(l,a):n.push({abort:l,cb:a})},sink:function(l){i!==void 0?i.sink(l):o.push(l)}}}var ie=!1;function nr(e,t,r){return ie?function(o){return _e(e(o),`${t} ${JSON.stringify(o)}`,r)}:e}function _e(e,t,r){return ie?{source:or(e.source,`${t} Source`,r),sink:lo(e.sink,`${t} Sink`,r)}:e}function or(e,t,r){return ie?function(o,i){r.write(`${t} end in (${typeof o}${o&&typeof o=="object"?`: ${Object.keys(o)}`:""}): ${o&&typeof o=="object"&&o.stack||o}`),e(o,function(c,s){r.write(`${t} end out (${typeof c}${c&&typeof c=="object"?`: ${Object.keys(c)}`:""}): ${c&&typeof c=="object"&&c.stack||c}`),r.write(`${t} data: ${s==null?void 0:s.toString("hex")}`),i(c,s)})}:e}function lo(e,t,r){return ie?function(o){e(or(o,t,r))}:e}var q=F(require("path")),cr=F(require("fs"));async function se(e,t=process.cwd(),r=process.env){if(process.platform!=="win32")return e;if(q.isAbsolute(e))return await Fe(e)||e;if(/[/\\]/.test(e)){let u=q.join(t,e);return await Fe(u)||u}let n,o;if(r){for(let u of Object.keys(r))if(u.toLowerCase()==="path"){let c=r[u];typeof c=="string"&&(n=c,o=c.split(q.delimiter).filter(Boolean),o.push(q.join(r.ProgramW6432||"C:\\Program Files","Docker\\Docker\\resources\\bin")));break}}if(o===void 0||o.length===0){let u=new Error(`No PATH to look up executable '${e}'.`);throw u.code="ENOENT",u}for(let u of o){let c;q.isAbsolute(u)?c=q.join(u,e):c=q.join(t,u,e);let s=await Fe(c);if(s)return s}let i=new Error(`Exectuable '${e}' not found on PATH '${n}'.`);throw i.code="ENOENT",i}var ir=process.env.PATHEXT,sr=ir?ir.toLowerCase().split(";"):[".com",".exe",".bat",".cmd"];async function Fe(e){if(sr.indexOf(q.extname(e))!==-1)return await ur(e)?e:void 0;for(let t of sr){let r=e+t;if(await ur(r))return r}}function ur(e){return new Promise(t=>cr.stat(e,(r,n)=>t(!r&&n.isFile())))}var gi=gn(),W=Se(),xn;try{xn=require(`${vn.dirname(process.argv[0])}/node_modules/node-pty`)}catch{}var Cn=JSON.parse(process.env.REMOTE_CONTAINERS_SOCKETS),yi={...Cn.reduce((e,t)=>(e[t]="duplex",e),{}),rpc:"async",connected:"async",ready:"async"},mi={exec:"async",stdin:"sink",stdout:"source",stderr:"source",exit:"async",terminate:"async",dispose:"async",ptyExec:"async",ptyIn:"sink",ptyOut:"source",ptyResize:"async",ptyExit:"async",ptyTerminate:"async",ptyDispose:"async",execToEnd:"async",setBaseEnv:"async",connect:"duplex"},T=process.env,L={},N={},yn=0,Z=gi(yi,mi)({exec:async(e,t)=>{try{let r=e.cwd,n=e.env?{...T,...e.env}:T,o=await se(e.cmd,r,n),i=Je.spawn(o,e.args,{cwd:r,env:n,windowsHide:!0}),u=yn++;L[u]={process:i,exit:new Promise((c,s)=>{i.once("error",s),i.once("close",(f,l)=>{c({code:f,signal:l})})}),stdin:W.sink(i.stdin),stdout:W.source(i.stdout),stderr:W.source(i.stderr)},t(null,u)}catch(r){t(r)}},stdin:e=>L[e].stdin,stdout:e=>L[e].stdout,stderr:e=>L[e].stderr,exit:(e,t)=>{L[e].exit.then(r=>t(null,r),t)},terminate:(e,t)=>{L[e].process.kill("SIGKILL"),t()},dispose:(e,t)=>{delete L[e],t()},ptyExec:async(e,t)=>{try{let{cwd:r,cols:n,rows:o}=e,i=e.env?{...T,...e.env}:T,u=await se(e.cmd,r,i),c=xn.spawn(u,e.args||[],{cwd:r,env:i,cols:n,rows:o}),s=[],f,l=c.onData(p=>{if(f){let d=f;f=void 0,d(null,p)}else s.push(p)}),a=yn++;N[a]={process:c,exit:new Promise(p=>{c.onExit(({exitCode:d,signal:g})=>p({code:d,signal:g}))}),in:p=>{p(null,function d(g,y){if(g!==!0){if(g)throw g;c.write(y),p(null,d)}})},out:(p,d)=>{if(p)return l.dispose(),s.length=0,d(p);if(s.length){let g=s.join("");s.length=0,d(null,g)}else f=d}},t(null,a)}catch(r){t(r)}},ptyIn:e=>N[e].in,ptyOut:e=>N[e].out,ptyResize:(e,t,r,n)=>{N[e].process.resize(t,r),n()},ptyExit:(e,t)=>{N[e].exit.then(r=>t(null,r),t)},ptyTerminate:(e,t)=>{N[e].process.kill("SIGKILL"),t()},ptyDispose:(e,t)=>{delete N[e],t()},execToEnd:async(e,t)=>{try{let r=e.cwd,n=e.env?{...T,...e.env}:T,o=await se(e.cmd,r,n),i=Je.spawn(o,e.args,{cwd:r,env:n,windowsHide:!0}),u=[];i.stdout.on("data",s=>u.push(s));let c=[];i.stderr.on("data",s=>c.push(s)),i.once("error",t),i.once("close",(s,f)=>{t(null,{stdout:Buffer.concat(u),stderr:Buffer.concat(c),code:s,signal:f})})}catch(r){t(r)}},setBaseEnv:(e,t)=>{T=e,t()},connect:nr(rr,"Remote Connect",{write:console.error})});(0,We.default)(W.source(process.stdin),Z.createStream(),W.sink(process.stdout));var En=Cn.map(async e=>{try{if(!(await(0,He.promisify)(j.lstat)(e)).isSocket())return;await(0,He.promisify)(j.unlink)(e)}catch(r){if(!(r&&r.code==="ENOENT"))throw r}let t=mn.createServer(r=>{r=_e(W.duplex(r),"Remote Listener",{write:console.error}),(0,We.default)(r,wi,Z[e](n=>{n&&console.error("Remote to local stream terminated with error:",n)}),r)});return new Promise(r=>t.listen(e,r))});function wi(e){return(t,r)=>{e(t,(n,o)=>{typeof n=="object"&&(n==null?void 0:n.code)==="ECONNRESET"&&(n=!0),r(n,o)})}}if(process.env.REMOTE_CONTAINERS_IPC){let e;En.push(new Promise(t=>e=t)),wn.createServer((t,r)=>{let n=[];t.on("data",o=>n.push(o)),t.on("end",()=>{Z.rpc(Buffer.concat(n).toString(),(o,i)=>{o?(console.error(o),r.writeHead(500),r.end()):(r.writeHead(200),r.write(i,u=>{u&&console.error(u)}),r.end())})})}).listen(process.env.REMOTE_CONTAINERS_IPC,e)}Promise.all(En).then(()=>Z.ready(e=>{e&&console.error(e)})).catch(e=>console.error(e));Z.connected(e=>{e&&console.error(e)});process.on("uncaughtException",e=>{j.writeSync(process.stderr.fd,String(e&&(e.stack||e.message)||e))});
//# sourceMappingURL=remoteContainersServer.js.map

